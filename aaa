import pandas as pd
import os

def split_csv_by_mandate(input_csv, output_dir):
    # Read the CSV file
    df = pd.read_csv(input_csv)
    
    # Ensure the output directory exists
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # Get unique values in the 'Mandate' column
    unique_mandates = df['Mandate'].unique()
    
    # Split the DataFrame based on unique 'Mandate' values and save to new CSV files
    for mandate in unique_mandates:
        mandate_df = df[df['Mandate'] == mandate]
        output_csv = os.path.join(output_dir, f'mandate_{mandate}.csv')
        mandate_df.to_csv(output_csv, index=False)
        print(f'Saved {output_csv}')
        
# Example usage:
# split_csv_by_mandate('input.csv', 'output_directory')
