import pandas as pd

# Example DataFrame (replace with your actual DataFrame)
data = {
    'Overall_status': ['Fail', 'Pass', 'Blocked', 'Pending_Delivery', 'Day2'],
    'TC_STATUS': ['Ready_to_Test', 'Ready_to_Test', 'Blocked', 'Pending_Delivery', 'Day2'],
    'PRODUCT_TYPE': ['nonexotic', 'nonexotic', 'nonexotic', 'nonexotic', 'nonexotic'],
    'EVENT_TYPE': ['newt', 'newt', 'newt', 'other', 'other']
}
df = pd.DataFrame(data)

# Define mapping of TC_STATUS to conditions
conditions = {
    'Ready_to_Test': ['Fail', 'Pass'],
    'Blocked': 'Blocked',
    'Pending_Delivery': 'Pending_Delivery',
    'Day2': 'Day2'
}

# Apply conditions to Overall_status
df['Overall_status'] = df.apply(lambda row: conditions[row['TC_STATUS']] if row['TC_STATUS'] in conditions else row['Overall_status'], axis=1)

# Group by PRODUCT_TYPE and EVENT_TYPE, and count the occurrences of each Overall_status
counts = df.groupby(['PRODUCT_TYPE', 'EVENT_TYPE', 'Overall_status']).size().unstack(-1).fillna(0).to_dict()

# Print the counts
print(counts)
