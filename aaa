import pandas as pd

def merge_product_type(df, df2):
    # Step 1: Merge df2 with df based on matching id and powerbi_tc_id
    merged_df = pd.merge(df2, df, left_on='powerbi_tc_id', right_on='id', how='left')
    
    # Step 2: Identify powerbi_tc_id values without a matching product_type
    missing_product_types = merged_df[merged_df['product_type'].isnull()]['powerbi_tc_id'].tolist()
    
    # Return the merged DataFrame with added product_type and the list of missing powerbi_tc_id
    return merged_df, missing_product_types

# Example DataFrames (replace with your actual DataFrames)
df = pd.DataFrame({
    'id': [1, 2, 3, 4, 5],
    'product_type': ['A', 'B', 'C', 'D', 'E']
})

df2 = pd.DataFrame({
    'powerbi_tc_id': [1, 2, 3, 6, 7],
    'other_column': ['X', 'Y', 'Z', 'P', 'Q']
})

# Call the method
merged_df, missing_product_types = merge_product_type(df, df2)

# Display the results
print("Merged DataFrame:")
print(merged_df)

print("\nPowerbi_tc_id values without a matching product_type:")
print(missing_product_types)
